
import javax.swing.*;
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

public class Gomoku extends JFrame {

    private static final int SIZE = 15;
    private static final int CELL = 40;

    private int[][] board = new int[SIZE][SIZE];
    private boolean blackTurn = true;
    private boolean gameOver = false;

    public Gomoku() {
        setTitle("äº”ç›®ä¸¦ã¹");
        setSize(SIZE * CELL + 16, SIZE * CELL + 39);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        add(new BoardPanel());
        setVisible(true);
    }

    class BoardPanel extends JPanel {

        public BoardPanel() {
            addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    if (gameOver) return;

                    int x = e.getX() / CELL;
                    int y = e.getY() / CELL;

                    if (x < 0 || y < 0 || x >= SIZE || y >= SIZE) return;
                    if (board[y][x] != 0) return;

                    board[y][x] = blackTurn ? 1 : 2;

                    if (checkWin(x, y)) {
                        gameOver = true;
                        JOptionPane.showMessageDialog(
                                null,
                                (blackTurn ? "é»’" : "ç™½") + "ã®å‹ã¡ï¼"
                        );
                    }

                    blackTurn = !blackTurn;
                    repaint();
                }
            });
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            // ç›¤é¢
            for (int i = 0; i < SIZE; i++) {
                g.drawLine(0, i * CELL, SIZE * CELL, i * CELL);
                g.drawLine(i * CELL, 0, i * CELL, SIZE * CELL);
            }

            // çŸ³
            for (int y = 0; y < SIZE; y++) {
                for (int x = 0; x < SIZE; x++) {
                    if (board[y][x] == 1) {
                        g.setColor(Color.BLACK);
                        g.fillOval(x * CELL + 5, y * CELL + 5, 30, 30);
                    } else if (board[y][x] == 2) {
                        g.setColor(Color.WHITE);
                        g.fillOval(x * CELL + 5, y * CELL + 5, 30, 30);
                        g.setColor(Color.BLACK);
                        g.drawOval(x * CELL + 5, y * CELL + 5, 30, 30);
                    }
                }
            }
        }
    }

    private boolean checkWin(int x, int y) {
        int stone = board[y][x];
        return count(x, y, 1, 0, stone)
             || count(x, y, 0, 1, stone)
             || count(x, y, 1, 1, stone)
             || count(x, y, 1, -1, stone);
    }

    private boolean count(int x, int y, int dx, int dy, int stone) {
        int cnt = 1;

        for (int i = 1; i < 5; i++) {
            int nx = x + dx * i;
            int ny = y + dy * i;
            if (nx < 0 || ny < 0 || nx >= SIZE || ny >= SIZE) break;
            if (board[ny][nx] != stone) break;
            cnt++;
        }

        for (int i = 1; i < 5; i++) {
            int nx = x - dx * i;
            int ny = y - dy * i;
            if (nx < 0 || ny < 0 || nx >= SIZE || ny >= SIZE) break;
            if (board[ny][nx] != stone) break;
            cnt++;
        }

        return cnt >= 5;
    }

    public static void main(String[] args) {
        new Gomoku();
    }
}

â–¶ å®Ÿè¡Œæ–¹æ³•
javac Gomoku.java
java Gomoku

ğŸ“Œ æ¬¡ã«ã§ãã‚‹æ”¹é€ ï¼ˆãƒ¬ãƒãƒ¼ãƒˆå‘ã‘ï¼‰

ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³è¿½åŠ 

å‹ã£ãŸ5å€‹ã‚’èµ¤ãè¡¨ç¤º

CPUå¯¾æˆ¦ï¼ˆç°¡å˜AIï¼‰

ã‚¯ãƒ©ã‚¹åˆ†å‰²ï¼ˆBoard / GameManagerï¼‰

ã‚„ã‚ŠãŸã„æ”¹é€ ã‚’è¨€ã£ã¦ãã‚ŒãŸã‚‰ã€
èª²é¡Œæå‡ºãƒ¬ãƒ™ãƒ«ã¾ã§ä¸€ç·’ã«ä»•ä¸Šã’ã‚‹ã‚ˆã€‚

æœ¬ã‚³ãƒ¼ã‚¹ã§ã¯ã€å®Ÿä¸–ç•Œã®å•é¡Œè§£æ±ºã«é‡è¦ãªæŠ€è¡“ã§ã‚ã‚‹æ·±å±¤å¼·åŒ–å­¦ç¿’ã«ã¤ã„ã¦ã€Pythonã€PyTorchã€OpenAIâ€‚Gymãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ç”¨ã„ã¦å­¦ã¶ã€‚å…·ä½“çš„ã«ã¯ã€CarRacingã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€šã˜ã¦ã€å¼·åŒ–å­¦ç¿’ã®åŸºæœ¬çš„ãªä»•çµ„ã¿ã‚„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¨­è¨ˆæ–¹æ³•ã«ã¤ã„ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã€‚ã•ã‚‰ã«ã€å®Ÿéš›ã«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’è¨­è¨ˆã—ã€å¼·åŒ–å­¦ç¿’ã‚’ç”¨ã„ã¦ãã‚Œã‚’å­¦ç¿’ã•ã›ã‚‹ã“ã¨ã§ã€ç†è«–ã ã‘ã§ãªãå®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ã‚‚ç¿’å¾—ã™ã‚‹ã€‚ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¯ãƒ¼ã‚¯ã‚’é€šã˜ã¦ã€å•é¡Œè§£æ±ºèƒ½åŠ›ã‚„ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’è‚²ã¿ã€æ·±å±¤å¼·åŒ–å­¦ç¿’ã®å®Ÿç”¨æ€§ã¨ãã®å¯èƒ½æ€§ã‚’ä½“é¨“ã—ã¦ã‚‚ã‚‰ã†ã€‚ã“ã®æˆæ¥­ã¯ã€æ·±å±¤å¼·åŒ–å­¦ç¿’ã®åŸºæœ¬çš„ãªçŸ¥è­˜ã‚’æŒã¤ã“ã¨ã‚’ç›®æŒ‡ã—ã€ãã®å¿œç”¨èƒ½åŠ›ã‚’é¤Šã†ã“ã¨ãŒç›®çš„ã§ã‚ã‚‹ã€‚ã“ã®æˆæ¥­ã®äºˆç¿’ã‚’ã™ã‚‹ã€‚ã¨ã«ã‹ãæ‰‹ã‚’å‹•ã‹ã—ã¦å­¦ã³ãŸã„ã€‚Gymnasiumã®ä½¿ã„æ–¹ã‚’æ•™ãˆã¦

ã„ã„å§¿å‹¢ã ã­ã€‚ã€Œã¨ã«ã‹ãæ‰‹ã‚’å‹•ã‹ã™ã€ã®ã¯æ·±å±¤å¼·åŒ–å­¦ç¿’ã§ã¯æœ€å¼·ã§ã™ 
ã“ã“ã§ã¯ Gymnasiumï¼ˆæ—§ OpenAI Gymï¼‰ã‚’è§¦ã£ã¦å‹•ã‹ã™æœ€çŸ­ãƒ«ãƒ¼ãƒˆã§èª¬æ˜ã—ã¾ã™ã€‚
â€» ã„ããªã‚Š CarRacing ã¯é‡ã„ã®ã§ã€ã¾ãšã¯è¶…ãƒŸãƒ‹ãƒãƒ  â†’ å¾ã€…ã«æœ¬ç•ªã«è¡Œãã¾ã™ã€‚

â‘  Gymnasiumã¨ã¯ä½•ã‹ï¼ˆè¶…é‡è¦ï¼‰

Gymnasiumã¯
ğŸ‘‰ ã€Œå¼·åŒ–å­¦ç¿’ã®ç·´ç¿’ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒã®é›†åˆã€

å¼·åŒ–å­¦ç¿’ã®åŸºæœ¬æ§‹é€ ã¯å¿…ãšã“ã‚ŒğŸ‘‡

ç’°å¢ƒ (Environment)
   â†‘        â†“
 è¦³æ¸¬      è¡Œå‹•
   â†‘        â†“
 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ


Gymnasiumã§ã¯ã“ã‚Œã‚’ APIã¨ã—ã¦çµ±ä¸€ã—ã¦ã„ã¾ã™ã€‚

â‘¡ ç’°å¢ƒæ§‹ç¯‰ï¼ˆã¾ãšã“ã“ï¼‰
1ï¸âƒ£ ä»®æƒ³ç’°å¢ƒï¼ˆå¼·ãæ¨å¥¨ï¼‰
python -m venv rl-env
source rl-env/bin/activate  # mac / linux

2ï¸âƒ£ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª
pip install gymnasium
pip install gymnasium[classic-control]
pip install numpy


CarRacingç”¨ï¼ˆå¾Œã§ï¼‰

pip install gymnasium[box2d]
pip install pygame

â‘¢ Gymnasiumã®æœ€å°ã‚³ãƒ¼ãƒ‰ï¼ˆè¶…é‡è¦ï¼‰

ã¾ãšã¯ CartPoleï¼ˆæ£’ç«‹ã¦ã‚²ãƒ¼ãƒ ï¼‰ã§ç†è§£ã™ã‚‹ã€‚

import gymnasium as gym

env = gym.make("CartPole-v1", render_mode="human")

obs, info = env.reset()

for step in range(500):
    action = env.action_space.sample()  # ãƒ©ãƒ³ãƒ€ãƒ è¡Œå‹•
    obs, reward, terminated, truncated, info = env.step(action)

    if terminated or truncated:
        obs, info = env.reset()

env.close()

ğŸ” ã“ã“ã§ä½•ãŒèµ·ãã¦ã‚‹ï¼Ÿ
è¦ç´ 	æ„å‘³
obs	è¦³æ¸¬ï¼ˆçŠ¶æ…‹ï¼‰
action	ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®è¡Œå‹•
reward	å ±é…¬
terminated	ã‚²ãƒ¼ãƒ çµ‚äº†
truncated	æ™‚é–“åˆ‡ã‚Œçµ‚äº†

ğŸ‘‰ å¼·åŒ–å­¦ç¿’ã¯ã“ã®5ã¤ã ã‘è¦šãˆã‚Œã°OK

â‘£ action_space / observation_space ã‚’ç†è§£ã™ã‚‹
print(env.action_space)
print(env.observation_space)

CartPoleã®å ´åˆ

action_space â†’ Discrete(2)
â†’ å·¦ or å³

observation_space â†’ Box(4)
â†’ ä½ç½®ãƒ»é€Ÿåº¦ãªã©4æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«

â‘¤ è‡ªåˆ†ã§ã€Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã‚’ä½œã‚‹ï¼ˆè¶…ç°¡å˜ï¼‰

ã¾ãšã¯ ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ï¼ˆå­¦ç¿’ãªã—ï¼‰

def simple_agent(obs):
    position, velocity, angle, angle_velocity = obs
    return 0 if angle < 0 else 1

action = simple_agent(obs)


ğŸ‘‰ ã“ã‚Œã ã‘ã§
ã€Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’è¨­è¨ˆã™ã‚‹ã€ä½“é¨“ã«ãªã‚‹ã€‚

â‘¥ PyTorchã¨ã¤ãªãï¼ˆè¶…é‡è¦ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆï¼ˆæœ€å°ï¼‰
import torch
import torch.nn as nn

class Policy(nn.Module):
    def __init__(self):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(4, 128),
            nn.ReLU(),
            nn.Linear(128, 2)
        )

    def forward(self, x):
        return self.net(x)

è¡Œå‹•ã‚’å‡ºã™
policy = Policy()

obs_tensor = torch.tensor(obs, dtype=torch.float32)
logits = policy(obs_tensor)
action = torch.argmax(logits).item()


ğŸ‘‰ ã“ã“ãŒã€Œæ·±å±¤ã€å¼·åŒ–å­¦ç¿’ã®å…¥å£

â‘¦ CarRacing ã«é€²ã‚€å‰ã«çŸ¥ã‚‹ã¹ãã“ã¨

CarRacing ã¯ é›£æ˜“åº¦ãŒä¸€æ°—ã«ä¸ŠãŒã‚‹ã€‚

ç†ç”±

è¦³æ¸¬ï¼šç”»åƒï¼ˆ96Ã—96Ã—3ï¼‰

è¡Œå‹•ï¼šé€£ç¶šå€¤ï¼ˆãƒãƒ³ãƒ‰ãƒ«ãƒ»ã‚¢ã‚¯ã‚»ãƒ«ãƒ»ãƒ–ãƒ¬ãƒ¼ã‚­ï¼‰

CNN ãŒå¿…è¦

PPO / DQN ãªã©ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¿…é ˆ

â‘§ CarRacing ã‚’ã€Œå‹•ã‹ã™ã ã‘ã€
import gymnasium as gym

env = gym.make("CarRacing-v2", render_mode="human")
obs, info = env.reset()

for _ in range(1000):
    action = env.action_space.sample()
    obs, reward, terminated, truncated, info = env.step(action)
    if terminated or truncated:
        obs, info = env.reset()

env.close()

action ã®ä¸­èº«
print(env.action_space)

Box([-1.  0.  0.], [1. 1. 1.])


steeringï¼ˆ-1ã€œ1ï¼‰

gasï¼ˆ0ã€œ1ï¼‰

brakeï¼ˆ0ã€œ1ï¼‰

â‘¨ æˆæ¥­å‰ã«ã€Œã“ã“ã¾ã§ã§ããŸã‚‰å‹ã¡ã€

æœ€ä½ãƒ©ã‚¤ãƒ³ğŸ‘‡

âœ… Gymnasiumã§ç’°å¢ƒã‚’å‹•ã‹ã›ã‚‹
âœ… obs / action / reward ã‚’èª¬æ˜ã§ãã‚‹
âœ… ãƒ©ãƒ³ãƒ€ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ›¸ã‘ã‚‹
âœ… PyTorchã§ç°¡å˜ãªNNã‚’ä½¿ãˆã‚‹

ä½™è£•ãŒã‚ã‚Œã°ğŸ‘‡

â­ CartPole ã‚’ NN ã§å®‰å®šã•ã›ã‚‹
â­ CarRacing ã‚’ã€Œèµ°ã‚‰ã›ã‚‹ã ã‘ã€

â‘© æ¬¡ã«ã‚„ã‚‹ã¹ãã“ã¨ï¼ˆãŠã™ã™ã‚é †ï¼‰

1ï¸âƒ£ CartPole + PyTorch ã§å­¦ç¿’ï¼ˆREINFORCEï¼‰
2ï¸âƒ£ CNNã®åŸºç¤ï¼ˆç”»åƒå…¥åŠ›ï¼‰
3ï¸âƒ£ PPOã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç†è§£
4ï¸âƒ£ CarRacingæœ¬æ ¼å®Ÿè£…

ã‚‚ã—ã‚ˆã‘ã‚Œã°æ¬¡ğŸ‘‡

REINFORCE ã‚’1ã‹ã‚‰å®Ÿè£…

CarRacingç”¨CNNè¨­è¨ˆ

ãƒ¬ãƒãƒ¼ãƒˆãƒ»ç™ºè¡¨ç”¨ã®èª¬æ˜æ–‡ä½œæˆ

ã©ã‚Œè¡Œãï¼Ÿ

 pip install gymnasium
error: externally-managed-environment

Ã— This environment is externally managed
â•°â”€> To install Python packages system-wide, try brew install
    xyz, where xyz is the package you are trying to
    install.
    
    If you wish to install a Python library that isn't in Homebrew,
    use a virtual environment:
    
    python3 -m venv path/to/venv
    source path/to/venv/bin/activate
    python3 -m pip install xyz
    
    If you wish to install a Python application that isn't in Homebrew,
    it may be easiest to use 'pipx install xyz', which will manage a
    virtual environment for you. You can install pipx with
    
    brew install pipx
    
    You may restore the old behavior of pip by passing
    the '--break-system-packages' flag to pip, or by adding
    'break-system-packages = true' to your pip.conf file. The latter
    will permanently disable this error.
    
    If you disable this error, we STRONGLY recommend that you additionally
    pass the '--user' flag to pip, or set 'user = true' in your pip.conf
    file. Failure to do this can result in a broken Homebrew installation.
    
    Read more about this behavior here: <https://peps.python.org/pep-0668/>

note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.
hint: See PEP 668 for the detailed specification.
takayanagihajime@takayanimenoAir ~ % ã“ã‚Œã©ã†ãªã£ã¦ã„ã‚‹

ã“ã‚Œã¯ macOS + Homebrew + Python3 ã‚ã‚‹ã‚ã‚‹ã® æ­£å¸¸ãªã‚¨ãƒ©ãƒ¼ ã§ã™ã€‚
å£Šã‚Œã¦ã„ã¾ã›ã‚“ã€‚ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚Œã°ä¸€ç¬ã§è§£æ±ºã—ã¾ã™ã€‚

çµè«–ï¼ˆæœ€çŸ­ï¼‰

ğŸ‘‰ ä»®æƒ³ç’°å¢ƒï¼ˆvenvï¼‰ã‚’ä½œã£ã¦ã€ãã®ä¸­ã§ pip install ã™ã‚‹
ã“ã‚ŒãŒ å”¯ä¸€ã®æ­£è§£ ã§ã™ã€‚

ä½•ãŒèµ·ãã¦ã„ã‚‹ã‹ï¼ˆè¶…é‡è¦ï¼‰

ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ğŸ‘‡

Homebrew ãŒç®¡ç†ã—ã¦ã„ã‚‹ Python ã«ã€pip ã§ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹

ã¨ã„ã†æ„å‘³ã§ã™ã€‚

ãªãœç¦æ­¢ï¼Ÿ

pip install ã‚’ system Python ã«ã‚„ã‚‹

â†’ Homebrew ãŒå…¥ã‚ŒãŸ Python ãŒå£Šã‚Œã‚‹

â†’ macOS å…¨ä½“ãŒä¸å®‰å®šã«ãªã‚‹

ãã‚Œã‚’é˜²ããŸã‚ã® PEP 668 ã¨ã„ã†ä»•æ§˜ã§ã™ã€‚

âŒ ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨
pip install gymnasium --break-system-packages


ğŸ‘‰ çµ¶å¯¾ãŠã™ã™ã‚ã—ãªã„ï¼ˆæœ¬å½“ã«å£Šã‚Œã‚‹ï¼‰

âœ… æ­£ã—ã„è§£æ±ºæ–¹æ³•ï¼ˆã“ã‚Œã ã‘ã‚„ã‚Œã°OKï¼‰
â‘  ä½œæ¥­ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
mkdir rl
cd rl

â‘¡ ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆ
python3 -m venv venv

â‘¢ ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–ï¼ˆé‡è¦ï¼‰
source venv/bin/activate


æˆåŠŸã™ã‚‹ã¨ğŸ‘‡

(venv) takayanagihajime@takayanimenoAir rl %

â‘£ ä»®æƒ³ç’°å¢ƒå†…ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install gymnasium
pip install gymnasium[classic-control]
pip install numpy


ğŸ‘‰ ã‚‚ã†ã‚¨ãƒ©ãƒ¼ã¯å‡ºã¾ã›ã‚“

ğŸ§ª å‹•ä½œç¢ºèªï¼ˆå¿…ãšã‚„ã‚‹ï¼‰
python - << EOF
import gymnasium as gym
env = gym.make("CartPole-v1")
print(env)
EOF


ã“ã‚ŒãŒå‡ºã‚Œã°æˆåŠŸğŸ‘‡

<TimeLimit<OrderEnforcing<PassiveEnvChecker<CartPoleEnv<CartPole-v1>>>>>

ğŸ”¥ ãªãœä»®æƒ³ç’°å¢ƒãŒå¿…é ˆã‹ï¼ˆæˆæ¥­çš„ã«é‡è¦ï¼‰

æ·±å±¤å¼·åŒ–å­¦ç¿’ã§ã¯ï¼š

PyTorch

Gymnasium

Box2D

CUDAï¼ˆå°†æ¥ï¼‰

ğŸ‘‰ ä¾å­˜é–¢ä¿‚ãŒåœ°ç„

ä»®æƒ³ç’°å¢ƒã‚’ä½¿ã‚ãªã„ã¨

èª²é¡ŒAãŒå‹•ã‹ãªã„

èª²é¡ŒBã§å£Šã‚Œã‚‹

æœ€æ‚ªPythonå†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ğŸ’¡ ã‚ˆãã‚ã‚‹å‹˜é•ã„
å‹˜é•ã„	çœŸå®Ÿ
pipãŒå£Šã‚Œã¦ã‚‹	macOSãŒå®ˆã£ã¦ãã‚Œã¦ã‚‹
ã‚¨ãƒ©ãƒ¼ã ã‹ã‚‰å¤±æ•—	æ­£å¸¸å‹•ä½œ
brewãŒæ‚ªã„	ã‚€ã—ã‚è¦ªåˆ‡
ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ä»®æƒ³ç’°å¢ƒã«å…¥ã£ãŸçŠ¶æ…‹ã§ğŸ‘‡

pip install torch
pip install gymnasium[box2d]
pip install pygame


ãã®ã‚ã¨
ğŸ‘‰ CarRacing ã‚’å®Ÿéš›ã«å‹•ã‹ã™

ã‚‚ã—

venv ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã‚‹ã‹ä¸å®‰

zsh / bash ã®é•ã„ã§è©°ã¾ã£ãŸ

VSCode ã§ä»®æƒ³ç’°å¢ƒãŒèªè­˜ã•ã‚Œãªã„

ã©ã‚Œã‹å‡ºãŸã‚‰ã€ãã®ã¾ã¾ã‚¨ãƒ©ãƒ¼è²¼ã£ã¦ã€‚
ã“ã“ã¯æˆæ¥­å‰ã«æ½°ã—ã¦ãŠãã¨è¶…æœ‰åˆ©ã€‚

 pip install gymnasium[classic-control]
zsh: no matches found: gymnasium[classic-control]
(venv) takayanagihajime@takayanimenoAir rl % 

ã“ã‚Œã¯ zsh ç‰¹æœ‰ã®ä»•æ§˜ ã«å¼•ã£ã‹ã‹ã£ã¦ã‚‹ã ã‘ã§ã€ã‚¨ãƒ©ãƒ¼ã˜ã‚ƒãªã„æœ¬è³ªçš„ãªå•é¡Œã¯ä½•ã‚‚èµ·ãã¦ã¾ã›ã‚“ã€‚
ä¸€è¨€ã§è¨€ã†ã¨ğŸ‘‡

zsh ãŒ [] ã‚’ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã¨ã—ã¦è§£é‡ˆã—ã¦ã—ã¾ã£ã¦ã„ã‚‹

âœ… å³è§£æ±ºï¼ˆã“ã®ã¾ã¾æ‰“ã¦ã°OKï¼‰
æ–¹æ³•â‘ ã€ä¸€ç•ªãŠã™ã™ã‚ã€‘
pip install "gymnasium[classic-control]"

æ–¹æ³•â‘¡ï¼ˆã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹ï¼‰
pip install gymnasium\[classic-control\]

ãªãœã“ã†ãªã‚‹ã®ã‹ï¼ˆç†è§£ç”¨ï¼‰

zsh ã§ã¯ï¼š

[] â†’ ãƒ•ã‚¡ã‚¤ãƒ«åã®ãƒ‘ã‚¿ãƒ¼ãƒ³


ã¤ã¾ã‚Š

gymnasium[classic-control]


ã‚’
ã€Œãã®åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã›ã€ã¨è§£é‡ˆã—ã¦ã—ã¾ã„ã€

no matches found


ã«ãªã‚‹ã€‚

bash ã ã¨èµ·ãã«ãã„ã‘ã©ã€zsh ã§ã¯è¶…é »å‡ºã€‚

âœ… æ­£ã—ã„ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ï¼ˆã¾ã¨ã‚ï¼‰
source venv/bin/activate
pip install gymnasium
pip install "gymnasium[classic-control]"
pip install numpy

ğŸ§ª å‹•ä½œç¢ºèªï¼ˆå¿…ãšï¼‰
python - << EOF
import gymnasium as gym
env = gym.make("CartPole-v1", render_mode="human")
env.reset()
print("OK")
env.close()
EOF


ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒå‡ºã‚Œã°æˆåŠŸ ğŸ‰

æ¬¡ã«ã‚„ã‚‹ã“ã¨ï¼ˆæˆæ¥­ç›´çµï¼‰

æ¬¡ã¯ğŸ‘‡ã®ã©ã‚Œã‹ã«é€²ã‚€ã®ãŒãƒ™ã‚¹ãƒˆï¼š

1ï¸âƒ£ CartPole ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã˜ã‚ƒãªãåˆ¶å¾¡ã™ã‚‹
2ï¸âƒ£ PyTorch ã¨ Gymnasium ã‚’æ¥ç¶šã™ã‚‹
3ï¸âƒ£ CarRacing ã‚’å‹•ã‹ã™æº–å‚™ï¼ˆbox2dï¼‰

ã©ã‚Œè¡Œãï¼Ÿ
ï¼ˆæˆæ¥­ã§è©•ä¾¡ä¸ŠãŒã‚‹é †ã‚‚æ•™ãˆã‚‰ã‚Œã‚‹ã‚ˆï¼‰

pip install pygame
Collecting pygame
  Downloading pygame-2.6.1.tar.gz (14.8 MB)
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 14.8/14.8 MB 4.6 MB/s  0:00:03
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: pygame
  Building wheel for pygame (pyproject.toml) ... error
  error: subprocess-exited-with-error
  
  Ã— Building wheel for pygame (pyproject.toml) did not run successfully.
  â”‚ exit code: 1
  â•°â”€> [14 lines of output]
      src_c/_sdl2/sdl2.c:1237:10: fatal error: 'SDL.h' file not found
      #include "SDL.h"
               ^~~~~~~
      1 error generated.
      Skipping Cython compilation
      
      ---
      For help with compilation see:
          https://www.pygame.org/wiki/MacCompile
      To contribute to pygame development see:
          https://www.pygame.org/contribute.html
      ---
      
      error: command '/usr/bin/clang' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for pygame
Failed to build pygame
error: failed-wheel-build-for-install

Ã— Failed to build installable wheels for some pyproject.toml based projects
â•°â”€> pygame

OKã€ã“ã‚Œã¯ macOS + pygame ã‚ã‚‹ã‚ã‚‹ï¼ˆç¬¬2é–¢é–€ï¼‰ã€‚
çµè«–ã‹ã‚‰è¨€ã†ã¨ğŸ‘‡

pygame è‡ªä½“ã¯æ‚ªããªã„ã€‚
SDL2ï¼ˆCã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ãŒå…¥ã£ã¦ã„ãªã„ã ã‘ã€‚

ä½•ãŒèµ·ãã¦ã„ã‚‹ã‹ï¼ˆè¶…é‡è¦ï¼‰

ã‚¨ãƒ©ãƒ¼ã®æ ¸å¿ƒã¯ã“ã“ğŸ‘‡

fatal error: 'SDL.h' file not found

æ„å‘³

pygame ã¯ å†…éƒ¨ã§ SDL2 ã¨ã„ã† C ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†

macOS ã«ã¯ SDL2 ãŒæ¨™æº–ã§å…¥ã£ã¦ã„ãªã„

â†’ ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦å¤±æ•—

ğŸ‘‰ Pythonã®å•é¡Œã˜ã‚ƒãªã„
ğŸ‘‰ Homebrewã§ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å…¥ã‚Œã‚‹ã®ãŒæ­£è§£

âœ… æ­£ã—ã„è§£æ±ºæ‰‹é †ï¼ˆãã®ã¾ã¾ã‚³ãƒ”ãƒšï¼‰
â‘  SDL2 ã‚’ Homebrew ã§å…¥ã‚Œã‚‹ï¼ˆã‚·ã‚¹ãƒ†ãƒ å´ï¼‰
brew install sdl2 sdl2_image sdl2_mixer sdl2_ttf


â€» ã“ã“ã¯ ä»®æƒ³ç’°å¢ƒã‚’æŠœã‘ã¦ã„ã¦ã‚‚OK

â‘¡ ä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹åŒ–ï¼ˆå¿µã®ãŸã‚ï¼‰
source venv/bin/activate

â‘¢ pygame ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pygame


ğŸ‘‰ ä»Šåº¦ã¯ wheel ãŒä½¿ã‚ã‚Œã‚‹ or æ­£ã—ããƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹

ğŸ§ª æˆåŠŸç¢ºèªï¼ˆå¿…ãšï¼‰
python - << EOF
import pygame
print(pygame.ver)
EOF


ã“ã‚ŒãŒå‡ºã‚Œã°OKğŸ‘‡

2.6.1

ğŸš¨ ã‚ˆãã‚ã‚‹ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆ
âŒ brew ãŒå…¥ã£ã¦ãªã„
brew --version


å‡ºãªã‘ã‚Œã°å…ˆã« brew ã‚’å…¥ã‚Œã‚‹å¿…è¦ã‚ã‚Šã€‚

âŒ Apple Siliconï¼ˆM1/M2ï¼‰ç‰¹æœ‰å•é¡Œï¼Ÿ

ä»Šå›ã®ã‚¨ãƒ©ãƒ¼ã¯ Intel / Apple Silicon å…±é€šã€‚
SDLä¸è¶³ãŒåŸå› ã€‚

ğŸ¯ ãªãœ CarRacing ã§ pygame ãŒå¿…è¦ï¼Ÿ

Gymnasium ã® renderï¼ˆç”»é¢è¡¨ç¤ºï¼‰

CarRacing-v2 ã¯ pygame ä¾å­˜

ã¤ã¾ã‚Šï¼š

pygame ãŒé€šã‚Œã°
ğŸ‘‰ CarRacing ã¾ã§ä¸€ç›´ç·š

æ¬¡ã«ã‚„ã‚‹ã“ã¨ï¼ˆã“ã“ã¾ã§æ¥ãŸã‚‰ã‚´ãƒ¼ãƒ«è¿‘ã„ï¼‰

ã“ã®é †ã§ğŸ‘‡

pip install gymnasium[box2d]


ãã—ã¦ğŸ‘‡

import gymnasium as gym
env = gym.make("CarRacing-v2", render_mode="human")
env.reset()


ã‚‚ã—æ¬¡ã§

box2d ãŒã‚³ã‚±ã‚‹

swig ãŒãªã„

import error ãŒå‡ºã‚‹

ğŸ‘‰ å…¨éƒ¨ macOS + å¼·åŒ–å­¦ç¿’ã‚ã‚‹ã‚ã‚‹ãªã®ã§ã€
ãã®ã¾ã¾ã‚¨ãƒ©ãƒ¼è²¼ã£ã¦ã€‚
ã“ã“è¶ŠãˆãŸã‚‰æˆæ¥­ã¯ã‹ãªã‚Šä½™è£•ã«ãªã‚‹ã€‚

source venv/bin/activate

(venv) takayanagihajime@takayanimenoAir rl % pip install pygame

Collecting pygame
  Using cached pygame-2.6.1.tar.gz (14.8 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: pygame
  Building wheel for pygame (pyproject.toml) ... error
  error: subprocess-exited-with-error
  
  Ã— Building wheel for pygame (pyproject.toml) did not run successfully.
  â”‚ exit code: 1
  â•°â”€> [14 lines of output]
      src_c/_sdl2/sdl2.c:1237:10: fatal error: 'SDL.h' file not found
      #include "SDL.h"
               ^~~~~~~
      1 error generated.
      Skipping Cython compilation
      
      ---
      For help with compilation see:
          https://www.pygame.org/wiki/MacCompile
      To contribute to pygame development see:
          https://www.pygame.org/contribute.html
      ---
      
      error: command '/usr/bin/clang' failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for pygame
Failed to build pygame
error: failed-wheel-build-for-install

Ã— Failed to build installable wheels for some pyproject.toml based projects
â•°â”€> pygame
(venv) takayanagihajime@takayanimenoAir rl % 

OKã€çŠ¶æ³ã¯ã¯ã£ãã‚Šã—ã¾ã—ãŸã€‚
åŸå› ã¯1ã¤ã ã‘ã§ã€ã—ã‹ã‚‚ macOS ã§ã¯ã‹ãªã‚Šé »å‡ºã§ã™ã€‚

çµè«–ï¼ˆä»Šãªã«ãŒèµ·ãã¦ã‚‹ï¼Ÿï¼‰
fatal error: 'SDL.h' file not found


ã“ã‚Œã¯ğŸ‘‡

Homebrew ã§ SDL2 ã‚’å…¥ã‚ŒãŸã‘ã©ã€
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ï¼ˆclangï¼‰ãŒãã®å ´æ‰€ã‚’è¦‹ã«è¡Œã‘ã¦ã„ãªã„

çŠ¶æ…‹ã§ã™ã€‚

ã¤ã¾ã‚Š

SDL2 âŒ æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ã§ã¯ãªã

SDL2 âœ… å…¥ã£ã¦ã„ã‚‹ï¼ˆor ã“ã‚Œã‹ã‚‰å…¥ã‚Œã‚‹ï¼‰ãŒ

ãƒ‘ã‚¹ãŒé€šã£ã¦ã„ãªã„

âœ… æ­£è§£ãƒ«ãƒ¼ãƒˆï¼ˆç¢ºå®Ÿã«é€šã™æ–¹æ³•ï¼‰
â‘  SDL2 ãŒå…¥ã£ã¦ã„ã‚‹ã‹ç¢ºèª
brew list | grep sdl2


ä½•ã‚‚å‡ºãªã‘ã‚Œã°ğŸ‘‡ã‚’å®Ÿè¡Œ

brew install sdl2 sdl2_image sdl2_mixer sdl2_ttf

â‘¡ SDL2 ã®å ´æ‰€ã‚’ç¢ºèªï¼ˆè¶…é‡è¦ï¼‰
brew --prefix sdl2


ã ã„ãŸã„ğŸ‘‡ã®ã©ã¡ã‚‰ã‹ãŒå‡ºã¾ã™ï¼š

Intel Mac

/usr/local/opt/sdl2


Apple Siliconï¼ˆM1/M2ï¼‰

/opt/homebrew/opt/sdl2

â‘¢ ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šï¼ˆã“ã“ãŒæ±ºå®šæ‰“ï¼‰

âš ï¸ å¿…ãšä»®æƒ³ç’°å¢ƒã‚’æœ‰åŠ¹ã«ã—ãŸã¾ã¾

source venv/bin/activate

Intel Mac ã®å ´åˆ
export CPPFLAGS="-I/usr/local/opt/sdl2/include"
export LDFLAGS="-L/usr/local/opt/sdl2/lib"

Apple Silicon ã®å ´åˆ
export CPPFLAGS="-I/opt/homebrew/opt/sdl2/include"
export LDFLAGS="-L/opt/homebrew/opt/sdl2/lib"

â‘£ pygame ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆã“ã“ã§é€šã‚‹ï¼‰
pip install pygame


ğŸ‘‰ ã“ã“ã§ SDL.h ã‚¨ãƒ©ãƒ¼ã¯æ¶ˆãˆã‚‹

ğŸ§ª æˆåŠŸç¢ºèªï¼ˆå¿…é ˆï¼‰
python - << EOF
import pygame
print(pygame.ver)
EOF

2.6.1


ãŒå‡ºãŸã‚‰å®Œå…¨å‹åˆ© ğŸ‰

ğŸ’¡ ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªå ´åˆï¼ˆæœ€çµ‚å…µå™¨ï¼‰
å…¬å¼ãƒã‚¤ãƒŠãƒªã‚’å¼·åˆ¶ä½¿ç”¨
pip install pygame --only-binary :all:


ï¼ˆã‚½ãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã‚’é¿ã‘ã‚‹ï¼‰

ğŸ¯ ãªãœã“ã“ãŒé¬¼é–€ã‹ï¼ˆæˆæ¥­çš„ã«ç†è§£ï¼‰

pygame = Python

SDL2 = C ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

macOS + Homebrew = ãƒ‘ã‚¹ç®¡ç†ãŒå³æ ¼

ğŸ‘‰ å¼·åŒ–å­¦ç¿’ã®ç’°å¢ƒæ§‹ç¯‰ã§
ä¸€ç•ªã¤ã¾ãšãã®ãŒã“ã“

ã§ã‚‚ä»Šã“ã“ã‚’è¶ŠãˆãŸã‚‰ğŸ‘‡

Gymnasium

CarRacing

PyTorch

å…¨éƒ¨ä¸€æ°—ã«é€²ã‚ã‚‰ã‚Œã‚‹ã€‚

æ¬¡ã®ä¸€æ‰‹ï¼ˆæˆåŠŸå¾Œï¼‰
pip install "gymnasium[box2d]"


ãã—ã¦ğŸ‘‡

import gymnasium as gym
env = gym.make("CarRacing-v2", render_mode="human")
env.reset()


ã‚‚ã—

Intel / Apple Silicon ã©ã£ã¡ã‹ã‚ã‹ã‚‰ãªã„

brew --prefix sdl2 ã®çµæœã‚’è¦‹ã¦åˆ¤æ–­ã—ã¦ã»ã—ã„

ãªã‚‰ã€ãã®å‡ºåŠ›ã‚’ãã®ã¾ã¾è²¼ã£ã¦ã€‚
ã“ã“ã¯ä¸€ç·’ã«è¶Šãˆã‚ˆã†ã€‚

import gymnasium as gym

# æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªç’°å¢ƒCartPoleã‚’ä½œæˆ
env = gym.make("CartPole-v1")

# ç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆ
observation, info = env.reset()

# ã„ãã¤ã‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œ
for _ in range(10):
    action = env.action_space.sample()
    observation, reward, terminated, truncated, info = env.step(action)
    
    if terminated or truncated:
        observation, info = env.reset()

env.close()
print("Gymnasiumã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼")ã“ã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã„ãŸã„ã€‚ã€€ãªã‚“ã¦ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã—ã¦ã€ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã©ã®ã‚ˆã†ã«ã‚¸ãƒ³ã‚ªã‚¦ã™ã‚Œã°ã„ã„ï¼Ÿ

OKã€ã“ã®ãƒ†ã‚¹ãƒˆãªã‚‰ã¨ã¦ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ ğŸ‘
é †ç•ªã«èª¬æ˜ã—ã¾ã™ã€‚

â‘  ãƒ•ã‚¡ã‚¤ãƒ«å

ä¾‹ã¨ã—ã¦ä¸€ç•ªç„¡é›£ãªã®ã¯ã“ã‚Œï¼š

test_gymnasium.py


ç†ç”±ï¼š

.py â†’ Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä¸­èº«ãŒã€ŒGymnasiumã®å‹•ä½œç¢ºèªã€ã ã¨åˆ†ã‹ã‚Šã‚„ã™ã„

ï¼ˆcartpole_test.py ã§ã‚‚ gym_test.py ã§ã‚‚OKï¼‰

â‘¡ ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã¨ä¿å­˜å ´æ‰€

ã„ã¾ä½œæ¥­ã—ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã“ã“ã§ã™ã‚ˆã­ï¼š

(venv) takayanagihajime@takayanimenoAir rl %


ãªã®ã§ rl ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ ã«ä¿å­˜ã—ã¾ã™ã€‚

touch test_gymnasium.py


ã‚¨ãƒ‡ã‚£ã‚¿ã§é–‹ãï¼ˆä¾‹ï¼‰ï¼š

nano test_gymnasium.py
# ã¾ãŸã¯
code test_gymnasium.py


ãã“ã«ğŸ‘‡ã®ã‚³ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ï¼š

import gymnasium as gym

# æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªç’°å¢ƒCartPoleã‚’ä½œæˆ
env = gym.make("CartPole-v1")

# ç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆ
observation, info = env.reset()

# ã„ãã¤ã‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œ
for _ in range(10):
    action = env.action_space.sample()
    observation, reward, terminated, truncated, info = env.step(action)

    if terminated or truncated:
        observation, info = env.reset()

env.close()
print("Gymnasiumã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼")

â‘¢ å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

ä»®æƒ³ç’°å¢ƒãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹çŠ¶æ…‹ã§ğŸ‘‡

python test_gymnasium.py


ã¾ãŸã¯ Python3 æ˜ç¤ºãªã‚‰ï¼š

python3 test_gymnasium.py

â‘£ æˆåŠŸã—ãŸã¨ãã®æŒ™å‹•

ç”»é¢è¡¨ç¤ºã¯å‡ºãªã„ï¼ˆCartPoleã¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¦ã„ãªã„ãŸã‚ï¼‰

æœ€å¾Œã«ã“ã‚ŒãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OK âœ…

Gymnasiumã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼

â‘¤ ã‚‚ã—ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰

ModuleNotFoundError: No module named 'gymnasium'
â†’ ä»®æƒ³ç’°å¢ƒãŒæœ‰åŠ¹ã§ãªã„

ImportError ç³»
â†’ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çŠ¶æ³ã‚’ç¢ºèª

pip show gymnasium


æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã¯

ğŸ® ç”»é¢è¡¨ç¤ºä»˜ãCartPole

ğŸ¤– å¼·åŒ–å­¦ç¿’ï¼ˆQ-learning / DQNï¼‰

ğŸ§  pygameã‚’ä½¿ã‚ãšGymã ã‘ã§é€²ã‚ã‚‹æ–¹æ³•

ã©ã‚Œè¡Œãï¼Ÿ

import gymnasium as gym

# ç’°å¢ƒã®ä½œæˆ
env = gym.make("CartPole-v1")

# ç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆã¨åˆæœŸè¦³æ¸¬ã®å–å¾—
observation, info = env.reset(seed=42)

# ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã®ãƒ«ãƒ¼ãƒ—
for _ in range(1000):
    # ãƒ©ãƒ³ãƒ€ãƒ ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é¸æŠï¼ˆå®Ÿéš›ã®AIãªã‚‰ã“ã“ã§æ–¹ç­–ã‚’ä½¿ç”¨ï¼‰
    action = env.action_space.sample()
    
    # ç’°å¢ƒã‚’1ã‚¹ãƒ†ãƒƒãƒ—é€²ã‚ã‚‹
    observation, reward, terminated, truncated, info = env.step(action)
    
    # ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ãŒçµ‚äº†ã—ãŸã‚‰ç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆ
    if terminated or truncated:
        observation, info = env.reset()

# ç’°å¢ƒã‚’é–‰ã˜ã‚‹
env.close()ã“ã‚Œã‚’å®Ÿè¡Œã—ã¦ç”»é¢ã«è¡¨ç¤ºã•ã›ãŸã„ã‘ã©python test_gymnasium.pyã“ã‚Œã§ã¯ä½•ã‚‚èµ·ã“ã‚‰ãªã«

ã“ã‚Œã¯ æ­£å¸¸ãªæŒ™å‹• ã§ã™ã€‚
ä»Šã®ã‚³ãƒ¼ãƒ‰ã¯ ç”»é¢æç”»ï¼ˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰ã‚’ä¸€åˆ‡ã—ã¦ã„ãªã„ ã®ã§ã€å®Ÿè¡Œã—ã¦ã‚‚ä½•ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

Gymnasiumã§ã¯
ğŸ‘‰ ç’°å¢ƒä½œæˆæ™‚ã« render_mode ã‚’æŒ‡å®šã—ãªã„ã¨ç”»é¢ã¯å‡ºã¾ã›ã‚“

âœ… ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®æœ€å°ä¿®æ­£
ğŸ”§ ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆã¯2ã¤ã ã‘

gym.make ã« render_mode="human" ã‚’è¿½åŠ 

env.render() ã¯ ä¸è¦ï¼ˆGymnasiumã§ã¯è‡ªå‹•ï¼‰

ğŸŸ¢ ç”»é¢è¡¨ç¤ºã§ãã‚‹ã‚³ãƒ¼ãƒ‰ï¼ˆå®Œæˆç‰ˆï¼‰
import gymnasium as gym

# â˜… render_mode ã‚’æŒ‡å®šã™ã‚‹
env = gym.make("CartPole-v1", render_mode="human")

# ç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆ
observation, info = env.reset(seed=42)

# ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã®ãƒ«ãƒ¼ãƒ—
for _ in range(1000):
    action = env.action_space.sample()
    observation, reward, terminated, truncated, info = env.step(action)

    if terminated or truncated:
        observation, info = env.reset()

env.close()

â–¶ å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ï¼ˆä»Šã¾ã§é€šã‚Šï¼‰
python test_gymnasium.py

ğŸ® å®Ÿè¡Œã™ã‚‹ã¨ã©ã†ãªã‚‹ï¼Ÿ

åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ CartPoleï¼ˆæ£’ãŒç«‹ã£ã¦ã‚‹ã‚„ã¤ï¼‰ ãŒè¡¨ç¤ºã•ã‚Œã‚‹

æ£’ãŒã™ãå€’ã‚Œã‚‹ï¼ˆãƒ©ãƒ³ãƒ€ãƒ è¡Œå‹•ãªã®ã§ï¼‰

å€’ã‚ŒãŸã‚‰è‡ªå‹•ã§ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹

Ã— ãƒœã‚¿ãƒ³ã§é–‰ã˜ã‚‹ã‹ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ çµ‚äº†ã§é–‰ã˜ã‚‹

âš  macOSã§æ³¨æ„ã™ã‚‹ã“ã¨
ã‚‚ã—ã“ã‚“ãªç—‡çŠ¶ãŒå‡ºãŸã‚‰ï¼š

ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒä¸€ç¬ã§æ¶ˆãˆã‚‹

ç”»é¢ãŒçœŸã£é»’

ğŸ‘‰ Pythonã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ç¢ºèª
ï¼ˆVSCodeã®ã€Œå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã ã¨è¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚ã‚Šï¼‰

ğŸ’¡ æ¬¡ã®ãƒ¬ãƒ™ãƒ«

ã“ã“ã¾ã§ã§ããŸã‚‰æ¬¡ã¯ï¼š

ğŸ§  ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹AI

ğŸ¤– Q-learning

ğŸ”¥ DQNï¼ˆCartPoleã‚’å€’ã‚Œãªãã™ã‚‹ï¼‰

ğŸ“ˆ å ±é…¬ã‚’printã—ã¦å­¦ç¿’ã®æ§˜å­ã‚’è¦‹ã‚‹

ã€Œæ¬¡ã¯å­¦ç¿’ã•ã›ãŸã„ã€ã€Œå¼·åŒ–å­¦ç¿’ã¨ã—ã¦ã¡ã‚ƒã‚“ã¨æ›¸ããŸã„ã€
ã©ã“ã¾ã§ã‚„ã‚ŠãŸã„ï¼Ÿ

ç¬¬2å›â€‚â€‚â€‚â€‚â€‚â€‚å¼·åŒ–å­¦ç¿’ã¨Python
æ·±å±¤å¼·åŒ–å­¦ç¿’ã‚’é€²ã‚ã‚‹ã«ã‚ãŸã£ã¦ã€å¿…è¦ã¨ãªã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªPythonã®åŸºç¤ã«ã¤ã„ã¦å­¦ã¶ã€‚
äºˆç¿’å†…å®¹ï¼šäº‹å‰é…å¸ƒè³‡æ–™ã‚’ç”¨ã„ãŸPythonã®äºˆç¿’(60åˆ†)
å¾©ç¿’å†…å®¹ï¼šPythonã®å¾©ç¿’ã¨èª²é¡Œã®å®Œæˆ(120åˆ†)ã“ã‚Œã«ã¤ã„ã¦å­¦ã¶ã€‚ã©ã®ã‚µã‚¤ãƒˆã‚’è¦‹ã‚‹ã¹ãï¼Ÿ

ã„ã„è³ªå•ã§ã™ã€‚
ã“ã®å›ã¯ ã€ŒPythonã‚’â€œä½¿ãˆã‚‹çŠ¶æ…‹â€ã«ã™ã‚‹ã€ ã®ãŒç›®çš„ã§ã€æ–‡æ³•ã‚’ç¶²ç¾…ã™ã‚‹ã‚ˆã‚Š
ğŸ‘‰ å¼·åŒ–å­¦ç¿’ã§å¿…è¦ãªéƒ¨åˆ†ã«çµã£ã¦æ‰‹ã‚’å‹•ã‹ã™ ã®ãŒæ­£è§£ã§ã™ã€‚

ä»¥ä¸‹ã¯ å„ªå…ˆåº¦ã¤ããƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— ã§ã™ï¼ˆå…¨éƒ¨ã‚„ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚

ğŸ”° æœ€å„ªå…ˆï¼ˆã“ã“ã¯å¿…ãšï¼‰
â‘  Pythonå…¬å¼ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆåŸºç¤ã®ç‹é“ï¼‰

ãŠã™ã™ã‚åº¦ï¼šâ˜…â˜…â˜…â˜…â˜…

ğŸ“˜ https://docs.python.org/ja/3/tutorial/

è¦‹ã‚‹ã¹ãç« ï¼ˆå…¨éƒ¨ã˜ã‚ƒãªãã¦OKï¼‰

3ç« ï¼šPythonã‚’ä½¿ã†

4ç« ï¼šåˆ¶å¾¡æ§‹æ–‡ï¼ˆif / for / whileï¼‰

5ç« ï¼šãƒ‡ãƒ¼ã‚¿æ§‹é€ 
â†’ list / tuple / dict / set

6ç« ï¼šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

8ç« ï¼šä¾‹å¤–å‡¦ç†

ğŸ‘‰ æ–‡æ³•ãŒæ­£ç¢ºãƒ»æˆæ¥­ã§çªã£è¾¼ã¾ã‚Œã¦ã‚‚å®‰å¿ƒ

ğŸ§  å¼·åŒ–å­¦ç¿’ã«ç›´çµï¼ˆè¶…é‡è¦ï¼‰
â‘¡ NumPy è¶…å…¥é–€

ãŠã™ã™ã‚åº¦ï¼šâ˜…â˜…â˜…â˜…â˜…

ğŸ“˜ https://numpy.org/doc/stable/user/absolute_beginners.html

æœ€ä½é™ã‚„ã‚‹ã“ã¨
import numpy as np

a = np.array([1, 2, 3])
b = np.zeros((4, 2))
c = np.random.rand(3, 3)


é…åˆ—ï¼ˆndarrayï¼‰

shape

æ¼”ç®—ï¼ˆ+ - * /ï¼‰

random

ğŸ‘‰ å¼·åŒ–å­¦ç¿’ï¼NumPy
ã“ã‚ŒãŒåˆ†ã‹ã‚‰ãªã„ã¨å¾Œã§è©°ã¿ã¾ã™ã€‚

ğŸ§ª å®Ÿé¨“ç”¨ãƒ»æ‰‹ã‚’å‹•ã‹ã™ç³»
â‘¢ Pythonãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆæ—¥æœ¬èªãƒ»çŸ­æ™‚é–“ï¼‰

ãŠã™ã™ã‚åº¦ï¼šâ˜…â˜…â˜…â˜…â˜†

ğŸ“˜ https://www.javadrive.jp/python/

æ–‡æ³•ãŒè»½ãã¾ã¨ã¾ã£ã¦ã„ã‚‹

æ¼”ç¿’ã—ã‚„ã™ã„

60åˆ†äºˆç¿’å‘ã

ğŸ® å¼·åŒ–å­¦ç¿’ç›®ç·šã§ãŠã™ã™ã‚
â‘£ OpenAI Gymnasium å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ãŠã™ã™ã‚åº¦ï¼šâ˜…â˜…â˜…â˜…â˜†

ğŸ“˜ https://gymnasium.farama.org/

è¦‹ã‚‹ã¹ããƒšãƒ¼ã‚¸

Basic Usage

Environments

step / reset ã®æˆ»ã‚Šå€¤

ğŸ‘‰ ä»Šã‚„ã£ã¦ã‚‹CartPoleã¨ç›´çµ

ğŸš€ ä½™åŠ›ãŒã‚ã‚Œã°ï¼ˆå¾©ç¿’120åˆ†å‘ã‘ï¼‰
â‘¤ PyTorch ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

ãŠã™ã™ã‚åº¦ï¼šâ˜…â˜…â˜…â˜†â˜†ï¼ˆå¾ŒåŠå‘ã‘ï¼‰

ğŸ“˜ https://pytorch.org/tutorials/

æœ€ä½é™ï¼š

Tensors

autogradï¼ˆå¾Œã§ï¼‰

â± 60åˆ†äºˆç¿’ãƒ¢ãƒ‡ãƒ«ãƒ—ãƒ©ãƒ³ï¼ˆãŠã™ã™ã‚ï¼‰
â° 0â€“20åˆ†

Pythonå…¬å¼ 4ç« ãƒ»5ç« ï¼ˆã–ã£ã¨ï¼‰

â° 20â€“40åˆ†

NumPyé…åˆ—ã‚’è§¦ã‚‹

import numpy as np
np.random.rand(5)

â° 40â€“60åˆ†

CartPoleã‚’å®Ÿè¡Œ

observation, reward ã‚’ print

ğŸ“ èª²é¡Œã§ã‚ˆãèã‹ã‚Œã‚‹ã“ã¨ï¼ˆå…ˆèª­ã¿ï¼‰

list ã¨ numpy array ã®é•ã„

foræ–‡ã¨ãƒ™ã‚¯ãƒˆãƒ«æ¼”ç®—

é–¢æ•°å®šç¾©

ã‚¯ãƒ©ã‚¹ï¼ˆAgentã§ä½¿ã†ï¼‰

è¾æ›¸ï¼ˆQ-tableï¼‰

ğŸ¯ æ­£ç›´ãªçµè«–

Pythonã‚’å®Œç’§ã«ç†è§£ã™ã‚‹å¿…è¦ã¯ãªã„
ã€Œèª­ã‚ã‚‹ãƒ»æ›¸ã‘ã‚‹ãƒ»å‹•ã‹ã›ã‚‹ã€ã§ååˆ†

ã‚‚ã—ã‚ˆã‘ã‚Œã°æ¬¡ã«ï¼š

ã€Œæˆæ¥­ã§å‡ºãã†ãªPythonèª²é¡Œã‚’äºˆæƒ³ã—ã¦ç·´ç¿’ã—ãŸã„ã€

ã€Œå¼·åŒ–å­¦ç¿’å‘ã‘PythonãƒŸãƒ‹ãƒ‰ãƒªãƒ«ä½œã£ã¦ã€

ã€ŒPythonçµŒé¨“ã»ã¼ã‚¼ãƒ­å‰æã§æ•™ãˆã¦ã€

ã©ã‚Œã§ã„ãï¼Ÿ

ã‚ã‚ŠãŒã¨ã†ã€‚ä»Šæ—¥ã®ã¨ã“ã‚ã¯ä»Šã¾ã§èã„ãŸã“ã¨ã®å†åº¦å®šç€ã«æ™‚é–“ã‚’å‰²ãã‚ˆã€‚ä»Šå¾Œã«ã¤ã„ã¦ç–‘å•ã¨ã„ã†ã‹ä¸å®‰ãŒã‚ã‚‹ã€‚ä»Šã¾ã§ã€ä½•ã‹å–ã‚Šçµ„ã‚“ã§ã‚‚2,3æ—¥ã—ãŸã‚‰ã™ãã«å¿˜ã‚Œã‚‹ã‚“ã ã€‚ã“ã‚Œã‚’ã©ã†ã«ã‹ã—ã¦æ²»ã—ãŸã„ã€‚ç†æƒ³ã¯ãã¡ã‚“ã¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚¨ãƒ©ãƒ¼ãŒè‡ªåˆ†ã§ã‚ã‹ã£ã¦è‡ªåˆ†ã§è§£æ±ºã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‚Šã€è‡ªç™ºçš„ã«ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã‚“ã ã€‚ã©ã†ã™ã‚Œã°ã„ã„ã‹ãª....

ã“ã¡ã‚‰ã“ãã€ç‡ç›´ã«è©±ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚
ãã®ä¸å®‰ã€ã‹ãªã‚Šå¤šãã®äººãŒåŒã˜ã¨ã“ã‚ã§ã¤ã¾ãšãã—ã€ã—ã‹ã‚‚ èƒ½åŠ›ä¸è¶³ã§ã¯ãªã„ ã‹ã‚‰å®‰å¿ƒã—ã¦ã»ã—ã„ã€‚

çµè«–ã‹ã‚‰è¨€ã†ã­ã€‚

ã€Œ2,3æ—¥ã§å¿˜ã‚Œã‚‹ã€ã®ã¯ç•°å¸¸ã˜ã‚ƒãªã„ã€‚
ã‚€ã—ã‚â€œæ­£ã—ã„å­¦ç¿’ãƒ—ãƒ­ã‚»ã‚¹ã«ã¾ã ä¹—ã‚Œã¦ã„ãªã„ã ã‘â€

ã“ã‚Œã¯æ²»ã›ã¾ã™ã€‚ã—ã‹ã‚‚ã€ã‚„ã‚Šæ–¹ã‚’å¤‰ãˆã‚Œã° ç¢ºå®Ÿã«æ”¹å–„ ã—ã¾ã™ã€‚

ã¾ãšå‰æã‚’ã²ã£ãã‚Šè¿”ã™ï¼ˆé‡è¦ï¼‰
âŒ ã‚ˆãã‚ã‚‹èª¤è§£

ã€Œç†è§£ã—ãŸã‚‰å¿˜ã‚Œãªã„ã¯ãšã€

ã€Œã§ãã‚‹äººã¯æœ€åˆã‹ã‚‰è‡ªåŠ›ã§ãƒ‡ãƒãƒƒã‚°ã§ãã‚‹ã€

ã€Œæ‰èƒ½ãŒã‚ã‚‹äººã ã‘ãŒä½œã‚Œã‚‹ã€

âœ… ç¾å®Ÿ

ç†è§£ã—ã¦ã‚‚æ™®é€šã«å¿˜ã‚Œã‚‹

ã§ãã‚‹äººã»ã©ã€å¿˜ã‚Œã‚‹å‰æã§è¨­è¨ˆã—ã¦ã„ã‚‹

è‡ªåŠ›ã§ä½œã‚Œã‚‹äººï¼â€œæ€è€ƒã®å‹â€ã‚’æŒã£ã¦ã„ã‚‹äºº

å¿˜ã‚Œã‚‹ã“ã¨è‡ªä½“ã¯å¤±æ•—ã˜ã‚ƒãªã„ã€‚
ã€Œå¿˜ã‚Œã‚‹å‰æã®æˆ¦ã„æ–¹ã€ã‚’çŸ¥ã‚‰ãªã„ã ã‘ã€‚

ãªãœ2,3æ—¥ã§å¿˜ã‚Œã‚‹ã®ã‹ï¼ˆè¶…é‡è¦ï¼‰

ç†ç”±ã¯1ã¤ã ã‘ã€‚

ã€Œæ€ã„å‡ºã™è¨“ç·´ã€ã‚’ã—ã¦ã„ãªã„

å¤šãã®äººã¯ï¼š

èª­ã‚€

èã

å†™ã™

ã“ã“ã§æ­¢ã¾ã‚‹ã€‚

ã§ã‚‚è„³ãŒå®šç€ã™ã‚‹ã®ã¯ğŸ‘‡
ã€Œæ€ã„å‡ºãã†ã¨ã—ã¦å¤±æ•—ã—ãŸã¨ãã€

è§£æ±ºç­–â‘ ï¼šæœ€å°ãƒªã‚³ãƒ¼ãƒ«å­¦ç¿’ï¼ˆã“ã‚ŒãŒæœ¬è³ªï¼‰
ã‚„ã‚‹ã“ã¨ã¯ã“ã‚Œã ã‘
â‘  å­¦ã‚“ã ãã®æ—¥ã®å¤œ or ç¿Œæ—¥

ğŸ‘‰ ä½•ã‚‚è¦‹ãšã«æ›¸ã

ä»Šæ—¥ã‚„ã£ãŸå†…å®¹ã‚’

ãƒãƒ¼ãƒˆ or ãƒ¡ãƒ¢ã«

5åˆ†ã§ã„ã„ã‹ã‚‰

ä¾‹ï¼ˆå¼·åŒ–å­¦ç¿’ãªã‚‰ï¼‰ï¼š

ãƒ»gym.make ã£ã¦ä½•ï¼Ÿ
ãƒ»reset ã®æˆ»ã‚Šå€¤ã¯ï¼Ÿ
ãƒ»step ã®æˆ»ã‚Šå€¤ã¯ï¼Ÿ


â— æ›¸ã‘ãªãã¦OK
â— é–“é•ã£ã¦OK

ã“ã“ã§è„³ãŒã€Œå¿…è¦ã ã€ã¨åˆ¤æ–­ã™ã‚‹ã€‚

è§£æ±ºç­–â‘¡ï¼šã‚¨ãƒ©ãƒ¼ã¯ã€Œæ•µã€ã˜ã‚ƒãªãã€Œæ•™æã€
è‡ªåŠ›ã§ã‚¨ãƒ©ãƒ¼ãŒåˆ†ã‹ã‚‹äººã®æ­£ä½“

å®Ÿã¯ğŸ‘‡
ã‚¨ãƒ©ãƒ¼æ–‡ã‚’1000å›ä»¥ä¸Šèª­ã‚“ã äºº

æ‰èƒ½ã˜ã‚ƒãªã„ã€‚

ä»Šæ—¥ã‹ã‚‰ã‚„ã‚‹ã€Œã‚¨ãƒ©ãƒ¼å¯¾å¿œãƒ†ãƒ³ãƒ—ãƒ¬ã€

ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰ã€å¿…ãšã“ã‚Œã‚’æ›¸ãï¼š

â‘  ã‚¨ãƒ©ãƒ¼å…¨æ–‡ã‚’èª­ã‚€
â‘¡ ã©ã®è¡Œï¼Ÿ
â‘¢ æ—¥æœ¬èªã§è¨€ã†ã¨ï¼Ÿ
â‘£ ä½•ãŒã€Œãªã„ / é•ã† / ä½™åˆ†ã€ï¼Ÿ


ä¾‹ï¼š

NameError: name 'env' is not defined

â†’ env ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„
â†’ ä½¿ã†å‰ã«ä½œã£ã¦ãªã„


ã“ã‚Œã‚’æ¯å›ã€‚

è§£æ±ºç­–â‘¢ï¼šã€Œè‡ªç™ºçš„ã«ä½œã‚Œã‚‹äººã€ã¸ã®æœ€çŸ­ãƒ«ãƒ¼ãƒˆ
ã„ããªã‚Šã€Œä½œã‚‹ã€ã¯ç„¡ç†ï¼ˆå…¨å“¡ï¼‰

ä»£ã‚ã‚Šã«ğŸ‘‡

ã€Œå°‘ã—å£Šã™ â†’ ç›´ã™ã€

ãŠã™ã™ã‚ç·´ç¿’æ³•ï¼ˆè¶…åŠ¹ãï¼‰
â‘  å‹•ãã‚³ãƒ¼ãƒ‰ã‚’ç”¨æ„
â‘¡ ã‚ã–ã¨1è¡Œæ¶ˆã™
â‘¢ ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã™
â‘£ ç›´ã™

ã“ã‚Œã ã‘ã€‚

ä¾‹ï¼š

# env = gym.make("CartPole-v1")  â† æ¶ˆã™
env.reset()


â†’ ã‚¨ãƒ©ãƒ¼
â†’ ç›´ã™
â†’ ç†è§£ãŒ1æ®µæ·±ããªã‚‹

è§£æ±ºç­–â‘£ï¼šå¿˜ã‚Œãªã„äººã®å­¦ç¿’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
ç†æƒ³çš„ãªã‚µã‚¤ã‚¯ãƒ«ï¼ˆç¾å®Ÿçš„ï¼‰

Day 1ï¼šå­¦ã¶

Day 2ï¼šä½•ã‚‚è¦‹ãšã«å†ç¾

Day 4ï¼šã‚‚ã†ä¸€åº¦å†ç¾

Day 7ï¼š1å›ã ã‘è§¦ã‚‹

ğŸ‘‰ åˆè¨ˆã§ã‚‚ 30åˆ†Ã—æ•°å›

è¶…å¤§äº‹ãªãƒ¡ãƒ³ã‚¿ãƒ«ã®è©±
ã“ã‚Œã ã‘ã¯ä¿¡ã˜ã¦ã»ã—ã„

ã€Œå¿˜ã‚Œã‚‹ã€ï¼ã‚µãƒœã‚Šã˜ã‚ƒãªã„

ã€Œã‚¨ãƒ©ãƒ¼ãŒåˆ†ã‹ã‚‰ãªã„ã€ï¼æ™®é€š

ã€Œä½œã‚Œãªã„ã€ï¼ã¾ã ææ–™ãŒå°‘ãªã„ã ã‘

ä»Šæ„Ÿã˜ã¦ã‚‹ä¸å®‰ã¯ã€æˆé•·ã—ã¦ã‚‹äººã«ã—ã‹å‡ºãªã„æ„Ÿæƒ…ã€‚

ä»Šæ—¥ã®ã‚ãªãŸã«åˆã†è¡Œå‹•ï¼ˆç¾å®Ÿãƒ—ãƒ©ãƒ³ï¼‰

ä»Šæ—¥ã¯ã“ã‚Œã§ååˆ†ğŸ‘‡

ä½•ã‚‚è¦‹ãšã«

gym.make

reset

step

ã‚’ç´™ or ãƒ¡ãƒ¢ã«æ›¸ãï¼ˆ5åˆ†ï¼‰

ãã‚Œã ã‘ã§OKã€‚

ã‚‚ã—æ¬¡ã«é€²ã‚€ãªã‚‰ï¼š

ğŸ”¹ã€Œå¿˜ã‚Œãªã„Pythonãƒãƒ¼ãƒˆã®ä½œã‚Šæ–¹ã€

ğŸ”¹ã€Œã‚¨ãƒ©ãƒ¼èª­è§£ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å•é¡Œã€

ğŸ”¹ã€Œè‡ªåˆ†ã§ä½œã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹æœ€å°èª²é¡Œé›†ã€

ã©ã‚Œã„ãï¼Ÿ
ç„¡ç†ã›ãšã€**ä¸€ç·’ã«â€œç©ã¿ä¸ŠãŒã‚‹ã‚„ã‚Šæ–¹â€ã«åˆ‡ã‚Šæ›¿ãˆã‚ˆã†ã€‚

githubã‚’æ´»ç”¨ã—ã¦æ˜æ—¥ã®è‡ªåˆ†ã«ä½•ã‹ã§ããªã„ã‹ï¼Ÿå•é¡Œã¨å›ç­”ã‚’ä½œã£ã¦ãŠãã¨ã‹

ãã‚Œã€ã‚ã¡ã‚ƒãã¡ã‚ƒè‰¯ã„ç™ºæƒ³ã€‚
çµè«–ã‹ã‚‰è¨€ã†ã¨ğŸ‘‡

GitHubã¯ã€Œæœªæ¥ã®è‡ªåˆ†ã«æ•™ãˆã‚‹ãŸã‚ã®æ•™æç½®ãå ´ã€ã«ã™ã‚‹ã¨æœ€å¼·

å˜ãªã‚‹ã‚³ãƒ¼ãƒ‰ç½®ãå ´ã˜ã‚ƒãªãã¦ã€
ã€Œå¿˜ã‚Œã‚‹å‰æã®è‡ªåˆ†ã€ã‚’åŠ©ã‘ã‚‹è£…ç½®ã«ã§ãã‚‹ã€‚

ã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼ˆã“ã‚ŒãŒæ ¸ï¼‰
ğŸ¯ ç›®çš„

æ˜æ—¥ã®è‡ªåˆ†ãŒ

è‡ªåŠ›ã§æ€ã„å‡ºãã†ã¨ã—ã¦

è©°ã¾ã£ã¦

ç­”ãˆã«ãŸã©ã‚Šç€ã‘ã‚‹

ğŸ‘‰ ã€Œå•é¡Œ â†’ ãƒ’ãƒ³ãƒˆ â†’ å›ç­”ã€æ§‹é€ 

ãŠã™ã™ã‚ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆï¼ˆè¶…å®Ÿç”¨ï¼‰
rl-study-log/
â”œâ”€ README.md
â”œâ”€ day01_gym_basics/
â”‚  â”œâ”€ problem.md
â”‚  â”œâ”€ hint.md
â”‚  â”œâ”€ answer.py
â”‚  â””â”€ memo.md
â”œâ”€ day02_cartpole/
â”‚  â”œâ”€ problem.md
â”‚  â”œâ”€ hint.md
â”‚  â”œâ”€ answer.py
â”‚  â””â”€ memo.md
â””â”€ mistakes.md

å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²
ğŸ“„ problem.mdï¼ˆæœªæ¥ã®è‡ªåˆ†ã¸ã®å•é¡Œï¼‰

è¦‹æœ¬

# å•é¡Œ Day01

1. Gymnasiumã§CartPoleç’°å¢ƒã‚’ä½œæˆã›ã‚ˆ
2. resetã®æˆ»ã‚Šå€¤ã‚’printã›ã‚ˆ
3. 10ã‚¹ãƒ†ãƒƒãƒ—åˆ†ã€ãƒ©ãƒ³ãƒ€ãƒ è¡Œå‹•ã‚’å®Ÿè¡Œã›ã‚ˆ

â€» å¤–éƒ¨è³‡æ–™ã‚’è¦‹ãšã«ã‚„ã‚‹ã“ã¨


ğŸ‘‰ ã“ã“ãŒä¸€ç•ªå¤§äº‹

ğŸ“„ hint.mdï¼ˆ30ç§’æ‚©ã‚“ã§ã‹ã‚‰è¦‹ã‚‹ï¼‰
- gym.make("ç’°å¢ƒå")
- resetã¯2ã¤è¿”ã™
- stepã¯5ã¤è¿”ã™


ğŸ‘‰ ã™ãç­”ãˆã‚’è¦‹ãªã„ãŸã‚ã®ã€Œã‚¯ãƒƒã‚·ãƒ§ãƒ³ã€

ğŸ§  answer.pyï¼ˆæ­£è§£ã‚³ãƒ¼ãƒ‰ï¼‰
import gymnasium as gym

env = gym.make("CartPole-v1")
obs, info = env.reset()

for _ in range(10):
    action = env.action_space.sample()
    obs, reward, terminated, truncated, info = env.step(action)
    if terminated or truncated:
        obs, info = env.reset()

env.close()

ğŸ“ memo.mdï¼ˆä»Šæ—¥ã®è‡ªåˆ†ã®æ°—ã¥ãï¼‰
- resetã¯ observation, info
- ç”»é¢è¡¨ç¤ºã¯ render_mode ãŒå¿…è¦
- step ã®æˆ»ã‚Šå€¤ã‚’ã‚ˆãå¿˜ã‚Œã‚‹


ğŸ‘‰ ã“ã‚ŒãŒæ˜æ—¥ã®è‡ªåˆ†ã®æ•‘å‘½ç´¢

è¶…é‡è¦ï¼šmistakes.mdï¼ˆæœ€å¼·ã®è³‡ç”£ï¼‰
# ã‚ˆãã‚„ã‚‹ãƒŸã‚¹é›†

- gym.make ã™ã‚‹å‰ã« reset ã—ãŸ
- render_mode="human" ã‚’å¿˜ã‚Œã¦ç”»é¢ãŒå‡ºãªã‹ã£ãŸ
- venvã‚’activateã—å¿˜ã‚ŒãŸ


ğŸ”¥ ã“ã‚ŒãŒæºœã¾ã‚‹ã»ã©å¼·ããªã‚‹

GitHubé‹ç”¨ãƒ«ãƒ¼ãƒ«ï¼ˆç¾å®Ÿçš„ï¼‰
âŒ ã‚„ã‚‰ãªãã¦ã„ã„

æ¯æ—¥ã‚³ãƒŸãƒƒãƒˆ

ç¶ºéº—ãªREADME

äººã«è¦‹ã›ã‚‹æ„è­˜

âœ… ã‚„ã‚‹ã¹ã

å•é¡Œã¯ã€Œå°ã•ãã€

ç­”ãˆã¯ã€Œå‹•ãã€

æ°—ã¥ãã¯ã€Œ1è¡Œã€

æ˜æ—¥ã®è‡ªåˆ†ã¸ã®æœ€é«˜ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ

ä»Šæ—¥ã‚„ã‚‹ã“ã¨ï¼ˆ15åˆ†ï¼‰ğŸ‘‡

GitHubã« rl-study-log ã‚’ä½œã‚‹

day01_gym_basics/problem.md ã‚’æ›¸ã

answer.py ã‚’ä¿å­˜

1ã‚³ãƒŸãƒƒãƒˆ

ã“ã‚Œã ã‘ã€‚

ã“ã‚ŒãŒãªãœåŠ¹ãã‹

æ€ã„å‡ºã™ â†’ è©°ã¾ã‚‹ â†’ è§£æ±º

è„³ãŒã€Œé‡è¦ã€ã ã¨åˆ¤æ–­ã™ã‚‹

è‡ªä¿¡ãŒç©ã¿ä¸ŠãŒã‚‹

ã€Œã¾ãŸå¿˜ã‚ŒãŸâ€¦ã€ãŒæ¸›ã‚‹

æ­£ç›´ã«è¨€ã†ã¨ã€
ã“ã®ã‚„ã‚Šæ–¹ãŒã§ãã‚‹äººã¯ä¼¸ã³ã‚‹ã€‚

æ¬¡ã¯ï¼Ÿ

GitHubåˆæœŸåŒ–ã‚³ãƒãƒ³ãƒ‰ä¸€å¼ï¼Ÿ

problem.mdã®ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’ä½œã‚‹ï¼Ÿ

æ˜æ—¥ã®å¾©ç¿’ç”¨ã€ŒDay02å•é¡Œã€ä½œã‚‹ï¼Ÿ

æ˜æ—¥ã®è‡ªåˆ†ã€ç¢ºå®Ÿã«åŠ©ã‹ã‚‹ã‚ˆ